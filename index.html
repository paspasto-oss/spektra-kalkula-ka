<!DOCTYPE html>
<html lang="sk">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Spektra Install – Energetická kalkulačka
  editon 2026</title>

  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;700;800&display=swap" rel="stylesheet">

  <style>
    :root {
      --brand-red: #D60000;
      --bg-light: #f4f4f4;
      --text-dark: #1a1a1a;
      --text-muted: #555;
      --border-color: #e0e0e0;
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      padding: 0;
      font-family: 'Montserrat', sans-serif;
      background-color: var(--bg-light);
      color: var(--text-dark);
      line-height: 1.4;
    }

    .wrapper { padding: 20px; max-width: 1100px; margin: auto; }

    .header { text-align: center; margin-bottom: 30px; }
    .header h1 {
      color: var(--brand-red);
      margin: 0;
      font-size: 1.6rem;
      font-weight: 800;
      text-transform: uppercase;
    }

    /* ✅ ZAROVNANIE KARIET (rovnaká výška v riadku) */
    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(450px, 1fr));
      gap: 25px;
      align-items: stretch; /* dôležité */
    }

    .card {
      background: #ffffff;
      padding: 25px;
      border-radius: 8px;
      border-left: 8px solid var(--brand-red);
      box-shadow: 0 4px 15px rgba(0,0,0,0.05);
      border: 1px solid var(--border-color);
      border-left-width: 8px;
      position: relative;

      /* dôležité pre zarovnanie výšok */
      display: flex;
      flex-direction: column;
    }

    .card-title {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 20px;
      border-bottom: 1px solid #eee;
      padding-bottom: 12px;
    }

    .card-title h2 {
      font-size: 1rem;
      margin: 0;
      color: var(--brand-red);
      text-transform: uppercase;
      font-weight: 800;
    }

    .card-title svg {
      width: 24px;
      height: 24px;
      fill: #000;
      flex: 0 0 auto;
    }

    /* ✅ ZAROVNANIE RIADKOV vo formulároch */
    .row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 15px;
      margin-bottom: 15px;
      align-items: end; /* inputy budú v jednej línii */
    }

    label {
      display: block;
      font-size: 0.75rem;
      color: var(--text-muted);
      margin-bottom: 6px;
      font-weight: 700;
    }

    input, select {
      width: 100%;
      background: #fff;
      border: 1px solid var(--border-color);
      padding: 10px;
      border-radius: 4px;
      color: var(--text-dark);
      font-size: 0.9rem;
      font-family: 'Montserrat', sans-serif;
      height: 44px; /* ✅ jednotná výška */
    }

    input:focus, select:focus { border-color: var(--brand-red); outline: none; }

    .res-item { margin-bottom: 15px; }
    .res-info {
      display: flex;
      justify-content: space-between;
      margin-bottom: 6px;
      font-weight: 700;
      font-size: 0.9rem;
    }

    .bar-bg { background: #f0f0f0; height: 10px; border-radius: 2px; overflow: hidden; }
    .bar-fill { height: 100%; background: var(--brand-red); transition: width 0.6s ease; }

    .summary-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 10px;
      margin-top: 20px;
    }

    .mini-box {
      background: #f9f9f9;
      padding: 12px;
      border-radius: 4px;
      text-align: center;
      border: 1px solid #eee;
    }

    .mini-box b {
      display: block;
      font-size: 0.6rem;
      color: var(--text-muted);
      text-transform: uppercase;
      margin-bottom: 4px;
    }

    .mini-box span {
      font-size: 1rem;
      font-weight: 800;
      color: var(--brand-red);
    }

    .btn-print {
      background: var(--brand-red);
      color: white;
      border: none;
      padding: 15px;
      border-radius: 4px;
      font-weight: 800;
      width: 100%;
      margin-top: 20px;
      cursor: pointer;
      text-transform: uppercase;
      font-family: 'Montserrat', sans-serif;
    }

    @media (max-width: 600px) {
      .grid { grid-template-columns: 1fr; }
      .row { grid-template-columns: 1fr; }
    }

    /* PRINT (PDF) */
    @media print {
      body { background:#fff; }
      .wrapper { padding: 0; max-width: none; }
      .grid { gap: 12px; }
      .card { box-shadow: none; border: 1px solid #ddd; }
      .btn-print { display:none; }
    }
  </style>
</head>
<body>

  <div class="wrapper">
    <div class="header">
      <h1>Energetická kalkulačka Spektra Install</h1>
    </div>

    <div class="grid">
      <!-- KARTA 1 -->
      <div class="card">
        <div class="card-title">
          <svg viewBox="0 0 24 24"><path d="M10,20V14H14V20H19V12H22L12,3L2,12H5V20H10Z"/></svg>
          <h2>Výpočet tepelnej straty</h2>
        </div>

        <div class="row">
          <div>
            <label>Vykurovaná plocha (m²)</label>
            <input type="number" id="area" value="150" min="0">
          </div>
          <div>
            <label>Izolácia budovy (W/m²)</label>
            <select id="insulation">
              <option value="100">Nízka (starý dom) ~100 W/m²</option>
              <option value="60" selected>Stredná (zateplený) ~60 W/m²</option>
              <option value="35">Veľmi dobrá (novostavba) ~35 W/m²</option>
            </select>
          </div>
        </div>

        <div class="row">
          <div>
            <label>Typ kúrenia</label>
            <select id="heating_type">
              <option value="floor" selected>Podlahovka (35°C)</option>
              <option value="rad">Radiátory (55°C)</option>
            </select>
          </div>
          <div>
            <label>Ohrev vody (TÚV)</label>
            <select id="dhw">
              <option value="1.2" selected>Áno (cca 4 osoby)</option>
              <option value="1.0">Nie</option>
            </select>
          </div>
        </div>

        <div class="row">
          <div>
            <label>Ročný koeficient prevádzky (kWh/kW·rok)</label>
            <input type="number" id="kwh_per_kw_year" value="2100" step="50" min="1200" max="3200">
            <div style="font-size:0.7rem;color:#666;margin-top:4px;">
              Orientačný počet hodín plného výkonu za rok. Bežná hodnota pre SR je <b>1800–2300</b> podľa lokality a typu domu.
            </div>
          </div>
          <div>
            <label>Porovnať úsporu voči</label>
            <select id="baseline">
              <option value="gas" selected>Zemný plyn</option>
              <option value="pellets">Pelety</option>
              <option value="wood">Drevo</option>
              <option value="res_el">Priamovýhrev elektrina</option>
            </select>
          </div>
        </div>
      </div>

      <!-- KARTA 2 -->
      <div class="card">
        <div class="card-title">
          <svg viewBox="0 0 24 24"><path d="M7,2H17A2,2 0 0,1 19,4V20A2,2 0 0,1 17,22H7A2,2 0 0,1 5,20V4A2,2 0 0,1 7,2M7,4V8H17V4H7M7,10V12H9V10H7M11,10V12H13V10H11M15,10V12H17V10H15M7,14V16H9V14H7M11,14V16H13V14H11M15,14V16H17V14H15M7,18V20H9V18H7M11,18V20H13V18H11M15,18V20H17V18H15Z"/></svg>
          <h2>Výkon a technológie</h2>
        </div>

        <label>Odporúčaný výkon TČ (kW)</label>
        <input type="text" id="hp_suggested" readonly style="font-weight:800; color:var(--brand-red); font-size:1.1rem;">

        <div class="row" style="margin-top:15px;">
          <div>
            <label>Elektrina (€/kWh)</label>
            <input type="number" id="p_el" step="0.01" value="0.20" min="0">
          </div>
          <div>
            <label>Základný SCOP (pred korekciou)</label>
            <input type="number" id="scop" step="0.1" value="3.5" min="1.5" max="6">
          </div>
        </div>

        <div class="row">
          <div>
            <label>Výsledný SCOP (po korekcii)</label>
            <input type="text" id="scop_eff" readonly style="font-weight:800;">
          </div>
          <div>
            <label>Poznámka</label>
            <input type="text" id="scop_note" readonly>
          </div>
        </div>
      </div>

      <!-- KARTA 3 -->
      <div class="card">
        <div class="card-title">
          <svg viewBox="0 0 24 24"><path d="M16,11.78L20.24,4.45L21.97,5.45L16.74,14.5L10.23,10.75L5.46,19H22V21H2V3H4V17.54L9.5,8L16,11.78Z"/></svg>
          <h2>Porovnávacie ceny</h2>
        </div>

        <div class="row">
          <div>
            <label>Plyn (€/kWh)</label>
            <input type="number" id="p_gas" step="0.010" value="0,042" min="0,042">
          </div>
          <div>
            <label>Drevo (€/prm)</label>
            <input type="number" id="p_wood" value="85" min="0">
          </div>
        </div>

        <div class="row">
          <div>
            <label>Pelety (€/t)</label>
            <input type="number" id="p_pellets" value="320" min="0">
          </div>
          <div>
            <label>Účinnosť plynu (%)</label>
            <input type="number" id="eff_gas" value="95" min="50" max="110">
          </div>
        </div>
      </div>

      <!-- KARTA 4 -->
      <div class="card">
        <div class="card-title">
          <svg viewBox="0 0 24 24"><path d="M16,11.78L20.24,4.45L21.97,5.45L16.74,14.5L10.23,10.75L5.46,19H22V21H2V3H4V17.54L9.5,8L16,11.78Z"/></svg>
          <h2>Porovnanie nákladov</h2>
        </div>

        <div id="resultsList"></div>

        <div class="summary-grid">
          <div class="mini-box"><b>Strata</b><span id="loss_val">0 kW</span></div>
          <div class="mini-box"><b>Potreba</b><span id="need_val">0 kWh</span></div>
          <div class="mini-box"><b>Úspora</b><span id="save_val">0 €</span></div>
        </div>

        <button class="btn-print" onclick="window.print()">Vytlačiť PDF</button>
      </div>
    </div>
  </div>

  <script>
    (function() {
      const ids = [
        'area','insulation','heating_type','dhw',
        'kwh_per_kw_year','baseline',
        'p_el','scop','p_gas','p_wood','p_pellets','eff_gas'
      ];

      function clamp(n, a, b){ return Math.max(a, Math.min(b, n)); }

      function calc() {
        const area = +document.getElementById('area').value || 0;
        const lossFactor = +document.getElementById('insulation').value || 0; // W/m²
        const dhw = +document.getElementById('dhw').value || 1.0;
        const kwhPerKwYear = +document.getElementById('kwh_per_kw_year').value || 2100;

        const lossKw = (area * lossFactor) / 1000;
        const hpPower = lossKw * dhw;
        const totalNeed = lossKw * kwhPerKwYear * dhw;

        document.getElementById('hp_suggested').value = (hpPower > 0 ? hpPower.toFixed(1) : '0.0') + ' kW';
        document.getElementById('loss_val').textContent = (lossKw > 0 ? lossKw.toFixed(1) : '0.0') + ' kW';
        document.getElementById('need_val').textContent = Math.round(totalNeed) + ' kWh';

        const baseScop = +document.getElementById('scop').value || 3.5;
        const sys = document.getElementById('heating_type').value;

        let scopAdj = 0;
        let note = 'Bez korekcie';
        if (sys === 'rad') { scopAdj = -0.5; note = 'Radiátory: nižší SCOP'; }
        if (sys === 'floor') { scopAdj = 0; note = 'Podlahovka: vyšší SCOP'; }

        const scopEff = clamp(baseScop + scopAdj, 1.2, 6.0);
        document.getElementById('scop_eff').value = scopEff.toFixed(2);
        document.getElementById('scop_note').value = note;

        const pEl = +document.getElementById('p_el').value || 0;
        const pGas = +document.getElementById('p_gas').value || 0;
        const pWood = +document.getElementById('p_wood').value || 0;
        const pPel = +document.getElementById('p_pellets').value || 0;
        const effGas = ((+document.getElementById('eff_gas').value || 95) / 100);

        const costHP = (totalNeed / scopEff) * pEl;
        const costGas = effGas > 0 ? (totalNeed / effGas) * pGas : Infinity;
        const costPel = (totalNeed / 0.88) * (pPel / 4800);
        const costWood = (totalNeed / 0.80) * (pWood / 1900);
        const costResEl = totalNeed * pEl;

        const costs = [
          { key:'hp', name: 'Tepelné čerpadlo', val: costHP },
          { key:'gas', name: 'Zemný plyn', val: costGas },
          { key:'pellets', name: 'Drevené pelety', val: costPel },
          { key:'wood', name: 'Palivové drevo', val: costWood },
          { key:'res_el', name: 'Elektrina (priamovýhrev)', val: costResEl }
        ].map(x => ({...x, val: isFinite(x.val) ? x.val : 0 }))
         .sort((a,b) => a.val - b.val);

        const max = Math.max(1, ...costs.map(c => c.val));

        document.getElementById('resultsList').innerHTML = costs.map(item => `
          <div class="res-item">
            <div class="res-info"><span>${item.name}</span><span>${Math.round(item.val)} €/rok</span></div>
            <div class="bar-bg"><div class="bar-fill" style="width:${(item.val/max)*100}%"></div></div>
          </div>
        `).join('');

        const baseline = document.getElementById('baseline').value;
        const baseItem = costs.find(c => c.key === baseline);
        const hpItem = costs.find(c => c.key === 'hp');
        const savings = Math.max(0, (baseItem?.val || 0) - (hpItem?.val || 0));
        document.getElementById('save_val').textContent = Math.round(savings) + ' €';

        // iframe auto-resize (ak použiješ)
        try {
          window.parent.postMessage({ type: 'spektra:resize', height: document.body.scrollHeight }, '*');
        } catch (e) {}
      }

      ids.forEach(id => {
        const el = document.getElementById(id);
        if (!el) return;
        el.addEventListener('input', calc);
        el.addEventListener('change', calc);
      });

      window.addEventListener('load', calc);
    })();
  </script>

</body>
</html>
